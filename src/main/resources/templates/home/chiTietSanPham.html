<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{/shared/layout :: layout(~{::title}, ~{::section})}">
<head>
  <title>Chi ti·∫øt s·∫£n ph·∫©m</title>
</head>
<body>
<section>
  <div class="container py-4">
    <div class="row g-4">

      <!-- H√¨nh ·∫£nh s·∫£n ph·∫©m -->
      <div class="col-md-6">
        <div class="card">
          <img th:src="${product.imgUrl != null ? product.imgUrl : '/photos/index-content/Chot.jpg'}"
               class="card-img-top"
               th:alt="${product.tenSP}">
          <div class="d-flex justify-content-center flex-wrap p-2">
            <!-- N·∫øu b·∫°n c√≥ danh s√°ch ·∫£nh ph·ª• sau n√†y c√≥ th·ªÉ th√™m th:each ·ªü ƒë√¢y -->
            <img th:src="${product.imgUrl}" class="img-thumbnail m-1" style="width: 90px;" alt="">
          </div>
        </div>
      </div>

      <!-- Th√¥ng tin s·∫£n ph·∫©m -->
      <div class="col-md-6">
        <h4 th:text="${product.tenSP}">T√™n s·∫£n ph·∫©m</h4>
        <div class="mb-2">
          <span th:text="${#numbers.formatDecimal(avgRating, 1, 1)} + ' ‚≠ê'">‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ</span>
          (<span th:text="${nhungDanhGia != null ? nhungDanhGia.size() : 0}"></span> ƒë√°nh gi√° c·ªßa kh√°ch h√†ng)
        </div>
        <h3 class="text-danger">
          <span th:text="${#numbers.formatDecimal(product.donGiaBan, 0, 'COMMA', 0, 'POINT')} + ' ƒë'">0 ƒë</span>
          <small class="text-muted text-decoration-line-through"
                 th:if="${donGiaGoc != null}"
                 th:text="${#numbers.formatDecimal(donGiaGoc, 0, 'COMMA', 0, 'POINT')} + ' ƒë'"></small>
        </h3>

        <ul class="list-unstyled">
          <li>üéÅ T·∫∑ng n√¢ng c·∫•p th√™m 8GB RAM MI·ªÑN PH√ç</li>
          <li>üéÅ T·∫∑ng t√∫i ch·ªëng s·ªëc tr·ªã gi√° 300.000 VNƒê</li>
          <li>üõ†Ô∏è B·∫£o h√†nh 12 th√°ng m√°y Fullbox</li>
          <li>‚ö° C√†i ƒë·∫∑t mi·ªÖn ph√≠ tr·ªçn ƒë·ªùi</li>
          <li>üöö Mi·ªÖn ph√≠ v·∫≠n chuy·ªÉn to√†n qu·ªëc</li>
          <li>üîÑ H·ªó tr·ª£ n√¢ng c·∫•p m√°y ƒë·ªïi m·ªõi nh·∫•t</li>
          <li>üíµ Gi√° ƒë√£ bao g·ªìm VAT</li>
        </ul>

        <!-- N√∫t h√†nh ƒë·ªông -->
        <div class="d-grid gap-2 my-3">
          <button class="btn btn-warning btn-lg">MUA NGAY</button>
          <form th:action="@{'/gio-hang/add/' + ${product.maSP}}" method="post" class="d-grid">
            <input type="hidden" name="soLuong" value="1"/>
            <input type="hidden" name="redirectUrl" th:value="@{'/SanPham/detail/' + ${product.maSP}}"/>
            <button type="submit" class="btn btn-primary btn-lg">
              <i class="bi bi-cart-plus me-1"></i> Th√™m v√†o gi·ªè h√†ng
            </button>
          </form>
        </div>

        <!-- Li√™n h·ªá -->
        <div class="p-3 border rounded bg-white">
          <h6>Hotline h·ªó tr·ª£:</h6>
          <p>
            H√† N·ªôi: <strong>0834.82.1988</strong><br>
            TP HCM: <strong>0911.71.2468</strong><br>
            ƒê√† N·∫µng: <strong>088.602.9669</strong><br>
            H·∫£i Ph√≤ng: <strong>088.629.6336</strong><br>
            Ngh·ªá An: <strong>088.639.3737</strong>
          </p>
        </div>
      </div>
    </div>

    <!-- Tabs m√¥ t·∫£ & ƒë√°nh gi√° -->
    <div class="row mt-5">
      <div class="col-12">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="desc-tab" data-bs-toggle="tab" data-bs-target="#desc" type="button" role="tab">
              M√¥ t·∫£ s·∫£n ph·∫©m
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="review-tab" data-bs-toggle="tab" data-bs-target="#review" type="button" role="tab">
              ƒê√°nh gi√°
            </button>
          </li>
        </ul>

        <div class="tab-content border p-3 bg-white" id="myTabContent">

          <!-- TAB M√î T·∫¢ S·∫¢N PH·∫®M -->
          <div class="tab-pane fade show active" id="desc" role="tabpanel">
            <p>
              <strong th:text="${product.tenSP}">T√™n s·∫£n ph·∫©m</strong>
              <br>
              <span th:text="${product.moTa != null ? product.moTa : 'Ch∆∞a c√≥ m√¥ t·∫£ cho s·∫£n ph·∫©m n√†y.'}"></span>
            </p>

            <ul>
              <li>Gi√° b√°n:
                <strong class="text-danger"
                        th:text="${#numbers.formatDecimal(product.donGiaBan, 0, 'COMMA', 0, 'POINT')} + ' ƒë'"></strong>
              </li>
              <li>S·ªë l∆∞·ª£ng t·ªìn:
                <strong th:text="${product.soLuongTon}"></strong>
              </li>
              <li>Tr·∫°ng th√°i:
                <span th:text="${product.trangThai ? 'C√≤n h√†ng' : 'H·∫øt h√†ng'}"></span>
              </li>
              <li>Lo·∫°i s·∫£n ph·∫©m:
                <span th:text="${product.loaiSanPham != null ? product.loaiSanPham.tenLoai : 'Kh√¥ng x√°c ƒë·ªãnh'}"></span>
              </li>
              <li>H√£ng:
                <span th:text="${product.hang != null ? product.hang.tenHang : 'Kh√¥ng x√°c ƒë·ªãnh'}"></span>
              </li>
            </ul>
          </div>

          <!-- TAB ƒê√ÅNH GI√Å -->
          <div class="tab-pane fade" id="review" role="tabpanel">
            <h5>ƒê√°nh gi√° trung b√¨nh:
              <span th:text="${#numbers.formatDecimal(avgRating, 1, 1)} + ' ‚≠ê'">0 ‚≠ê</span>
            </h5>

            <div th:if="${nhungDanhGia != null and !nhungDanhGia.isEmpty()}">
              <div th:each="rv : ${nhungDanhGia}" class="border-bottom pb-2 mb-2">
                <p>
                  <strong th:text="${rv.user.hoTen}">T√™n ng∆∞·ªùi d√πng</strong>
                  <small class="text-muted ms-2"
                         th:text="${#temporals.format(rv.ngayDanhGia, 'dd/MM/yyyy HH:mm')}">01/01/2025</small>
                </p>
                <p>
                  <span class="text-warning" th:text="${'‚≠ê'.repeat(rv.soSao)}">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                </p>
                <p th:text="${rv.noiDung}">N·ªôi dung ƒë√°nh gi√°</p>
              </div>
            </div>

            <div th:if="${nhungDanhGia == null or nhungDanhGia.isEmpty()}">
              <p>Ch∆∞a c√≥ ƒë√°nh gi√° n√†o cho s·∫£n ph·∫©m n√†y.</p>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>
</section>
</body>
</html>
